<Qucs Schematic 24.2.1>
<Properties>
  <View=-9032,-1312,7215,5004,0.313843,2573,404>
  <Grid=10,10,1>
  <DataSet=bridge_active_pfc_fet_current_ctl.dat>
  <DataDisplay=bridge_active_pfc_fet_current_ctl.dpl>
  <OpenDisplay=1>
  <Script=bridge_active_pfc_fet_current_ctl.m>
  <RunScript=0>
  <showFrame=0>
  <FrameText0=Title>
  <FrameText1=Drawn By:>
  <FrameText2=Date:>
  <FrameText3=Revision:>
</Properties>
<Symbol>
</Symbol>
<Components>
  <DIODE_SPICE D1 1 700 280 15 -26 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0 "2" 1 "D" 1>
  <DIODE_SPICE D2 1 700 440 15 -26 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0 "2" 1 "D" 1>
  <SpiceModel DI_1N1 1 190 750 -30 15 0 0 ".MODEL DI_1N5408 D  ( IS=63.0n RS=14.1m BV=1.00k IBV=10.0u " 1 "+ CJO=53.0p  M=0.333 N=1.70 TT=4.32n )" 1 "" 0 "" 0 "Line_5=" 0>
  <DIODE_SPICE D3 1 460 280 15 -26 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0 "2" 1 "D" 1>
  <DIODE_SPICE D4 1 460 440 11 10 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0 "2" 1 "D" 1>
  <VProbe Pr1 1 1470 300 28 -31 0 0>
  <R R1 1 1360 510 15 -26 0 1 "{R_LOAD}" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <IProbe Pr2 1 1220 410 -41 -26 0 3>
  <IProbe Pr3 1 1360 410 -41 -26 0 3>
  <NutmegEq NutmegBridge1 1 1120 680 -27 15 0 0 "tran" 1 "P_L_t=V(Pr1) * vpr4#branch" 1 "P_I_t=V(Pr5) * vpr2#branch" 1 "V_I_rms=sqrt(mean(V(Pr5)^2))" 1 "I_I_rms=sqrt(mean(vpr2#branch^2))" 1 "V_O_rms=sqrt(mean(V(Pr1)^2))" 1 "I_O_rms=sqrt(mean(vpr4#branch^2))" 1 "V_O_ripple=vecmax(V(Pr1)) - vecmin(V(Pr1))" 1>
  <DIODE_SPICE D5 1 1090 320 -26 15 0 0 "DI_ES3C2" 1 "" 0 "" 0 "" 0 "" 0 "2" 1 "D" 1>
  <R R3 1 1220 590 15 -26 0 1 "0.2 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <SpiceModel SWITCH1 1 190 660 -30 15 0 0 ".model switch1 sw vt=0.5 vh=0.2 ron=0.03 roff=1e7" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <R R6 1 880 250 -35 34 0 1 "10 MegOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <VProbe Pr7 1 1180 230 -16 28 0 3>
  <SpiceModel SpiceModel_DI_ES3C1 1 190 850 -30 15 0 0 ".MODEL DI_ES3C D  ( IS=7.27p RS=22.4m BV=1.00k IBV=10.0u" 1 "+ CJO=83.2p  M=0.333 N=0.700 TT=36.0n )" 1 "" 0 "" 0 "Line_5=" 0>
  <GND * 1 1260 260 0 0 0 0>
  <C C3 0 1260 210 17 -26 0 1 "10 uF" 1 "" 0 "neutral" 0>
  <R R2 1 830 170 -26 15 0 0 "0.2 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <IProbe Pr8 1 750 170 -26 16 0 0>
  <Vac V1 1 610 370 -35 -71 0 2 "{V_LINE_NOM_PK}" 1 "50 Hz" 1 "90" 0 "0" 0 "0" 0 "0" 0>
  <.DC DC1 1 840 940 0 49 0 0 "26.85" 0 "0.001" 0 "1 pA" 0 "1 uV" 0 "no" 0 "150" 0 "no" 0 "none" 0 "CroutLU" 0>
  <SpiceModel SpiceModel_DI_ES3C2 1 210 1270 -30 15 0 0 ".MODEL DI_ES3C2 D  ( IS=7.27p RS=22.4m BV=1.00k IBV=10.0u" 1 "+ CJO=83.2p  M=0.333 N=0.700 TT=32.0n )" 1 "" 0 "" 0 "Line_5=" 0>
  <IProbe Pr4 1 530 370 -26 16 1 2>
  <VProbe Pr5 1 610 450 -57 3 1 0>
  <SpiceModel SpiceModel_pmod_g_drv 1 210 1450 -30 15 0 0 ".MODEL pmod_g_drv pmos(VTO=-2.0 KP=0.010)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SpiceModel_nmod_g_drv 1 210 1370 -30 15 0 0 ".MODEL nmod_g_drv nmos(VTO=3.0 KP=0.015)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <INCLSCR INCLSCR1 1 220 240 -68 15 0 0 "\n.CONTROL\nSET D_BRIDGE_MODEL=''DI_1N5408''\n.ENDC" 1 "" 0 "" 0>
  <SpiceModel SpiceModel_mult_ref 1 210 1800 -30 15 0 0 ".MODEL mult_ref mult" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SpiceModel_summer_error 1 210 1690 -30 15 0 0 ".MODEL summer_error summer( in_offset = [0.0 0.0]," 1 "+   in_gain = [1.0 -1.0])" 1 "" 0 "" 0 "Line_5=" 0>
  <L L1 1 980 250 5 -46 0 1 "2.7 mH" 1 "" 0>
  <GND * 0 670 370 0 0 0 0>
  <SPICEINIT SPICEINIT1 1 190 570 -31 15 0 0 "set ngbehavior=ltpsa" 1>
  <SpiceOptions SpiceOptions1 1 190 400 -37 15 0 0 "DEVICE" 0 "GMIN=1e-12" 1 "METHOD=gear" 1 "RELTOL=1m" 1 "VNTOL=1m" 1 "ABSTOL=1u" 1>
  <SpiceModel SpiceModel_clk 1 210 1890 -30 15 0 0 ".MODEL clk square( cntl_array = [-1 1]," 1 "+   freq_array = [{F_S/2} {3*F_S/2}]," 1 "+   out_low = -1.0, out_high = 1.0," 1 "+   duty_cycle = 0.01," 1 "Line_5=+   rise_time = 5.0e-9, fall_time = 5.0e-9)" 1>
  <GND * 1 760 620 0 0 0 0>
  <R R8 1 910 620 -26 15 0 0 "{R_SENSE}" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <SpicePar BOOST_PFC_PARAM 1 1580 180 -29 15 0 0 "PI=3.1415927" 1 "V_F=0.7" 1 "V_LINE_MIN_RMS=85" 1 "V_LINE_MAX_RMS=265" 1 "V_LINE_NOM_RMS=230" 1 "V_LINE_NOM_PK={V_LINE_NOM_RMS * sqrt(2)}V" 1 "V_LINE_MAX_PK={V_LINE_MAX_RMS * sqrt(2)}V" 1 "V_LINE_MIN_PK={V_LINE_MIN_RMS * sqrt(2)}V" 1 "V_RECT_NOM_RMS={(V_LINE_NOM_PK - 2 * V_F) / sqrt(2)}" 1 "V_RECT_MIN_RMS={(V_LINE_MIN_PK - 2 * V_F) / sqrt(2)}" 1 "V_AVG={V_LINE_NOM_PK * 2 / PI}V" 1 "V_O=371.5V" 1 "ETA_EST=0.90" 1 "P_LOAD=96.0W" 1 "P_IN={P_LOAD / ETA_EST}" 1 "R_LOAD={V_O^2 / P_LOAD}O" 1 "F_S=200k" 1 "T_S={1 / F_S}" 1 "D=0.1281" 1 "T_ON={T_S * D}" 1 "T_OFF={T_S * (1 - D)}" 1 "T_R=10e-9" 1 "T_F=10e-9" 1 "R_SENSE=100mO" 1 "I_SENSE_NOM_PK={P_IN / V_RECT_NOM_RMS * sqrt(2)}" 1 "I_SENSE_MAX_PK={P_IN / V_RECT_MIN_RMS * sqrt(2)}" 1 "V_ISENSE_FS=10V" 1>
  <SpiceModel SpiceModel_gain_inv 1 630 2230 -30 15 0 0 ".MODEL gain_inv gain(gain = -5.0, out_offset = 5.0)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SpiceModel_gain_inv_1 1 630 2150 -30 15 0 0 ".MODEL gain_inv_1 gain(in_offset = -1.0, gain = -1.0, out_offset = 12.0)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SpiceModel_clk_12v 1 210 2050 -30 15 0 0 ".MODEL clk12v square(cntl_array = [-1 1]," 1 "+   freq_array = [{F_S/2} {3*F_S/2}]," 1 "+   out_low = 1.0, out_high = 13.0," 1 "+   duty_cycle = 0.1281," 1 "Line_5=+   rise_time = 10.0e-9, fall_time = 10.0e-9)" 1>
  <Vdc V4 1 600 970 18 -26 0 1 "12 V" 1>
  <GND * 1 1040 1100 0 0 0 0>
  <VProbe Pr6 1 1030 1060 28 -31 0 0>
  <R R7 1 950 1080 -26 15 0 0 "5 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <PMOS_SPICE M2 1 760 1030 28 -21 0 0 "pmod_g_drv" 1 "" 0 "" 0 "" 0 "" 0>
  <NMOS_SPICE M1 1 760 1130 35 1 0 0 "nmod_g_drv" 1 "" 0 "" 0 "" 0 "" 0>
  <Vrect V2 0 220 1120 18 -26 0 1 "10 V" 1 "5 us" 1 "5 us" 1 "1 ns" 0 "1 ns" 0 "0 ns" 0 "0 V" 1>
  <XSPICE_A A6 1 500 1080 -35 -76 0 0 "v,v" 1 "gain_inv_1" 1>
  <VProbe Pr_V_DRV_G 1 620 1130 -16 28 0 3>
  <VProbe Pr_V_DRV 1 440 1130 -16 28 0 3>
  <vPWL V3 0 360 1120 -77 101 0 1 "DC 1.0 PWL (0 0 T_R 12 {T_ON} 12 {T_ON + T_F} 0 {T_S} 0) r=0" 1 "" 0 "" 0 "" 0 "" 0 "" 0 "" 0 "" 0 "" 0 "" 0>
  <GND * 1 1610 950 0 0 0 0>
  <SPICE X1 0 1610 890 -56 -3 1 2 "/home/jsr/dev/led-supply/spice/spice-model-tp65h480g4/TP65H480G4 Model rev1.0.txt" 0 "_net301,_net302,_net303" 0 "yes" 0 "none" 0>
  <SpLib X2 1 950 450 -26 51 1 2 "/home/jsr/dev/led-supply/spice/irfp460n.lib" 0 "irfp460n" 1 "auto" 0 "" 0>
  <C C1 1 1220 510 17 -26 0 1 "914u" 1 "-390" 0 "neutral" 0>
  <SpiceModel SpiceModel_limiter_0_10 1 210 2210 -30 15 0 0 ".MODEL limiter_0_10 limit(out_lower_limit=0.0," 1 "+   out_upper_limit=10.0)" 1 "" 0 "" 0 "Line_5=" 0>
  <GND * 1 600 1020 0 0 0 0>
  <GND * 1 680 1190 0 0 0 0>
  <C C2 1 1060 250 7 9 0 1 "1 pF" 1 "" 0 "neutral" 0>
  <.TR TR1 1 840 680 0 83 0 0 "lin" 1 "0 ms" 1 "2 ms" 1 "10001" 1 "Gear" 1 "3" 1 "1 ns" 0 "1e-16" 0 "150" 0 "0.01" 0 "1 uA" 0 "1 mV" 0 "26.85" 0 "1e-3" 0 "1e-6" 0 "1" 0 "CroutLU" 0 "no" 0 "no" 0 "1ns" 1>
  <SpiceModel SpiceModel_pwm_pulse 1 210 1560 -30 15 0 0 ".MODEL pwm_pulse oneshot(cntl_array = [0 10]," 1 "+   pw_array=[0 {T_S}], out_low=0.0, out_high=12.0," 1 "+   fall_time=10.0e-9, rise_time=10.0e-9)" 1 "" 0 "Line_5=" 0>
  <OpAmp OP1 1 -530 720 -26 42 0 0 "1e6" 1 "15 V" 0>
  <GND * 1 -590 1010 0 0 0 0>
  <GND * 1 -590 1300 0 0 0 0>
  <XSPICE_A A3 1 -430 1220 -49 -108 0 1 "[v,v],v" 1 "mult_ref" 1>
  <GND * 1 -460 1380 0 0 0 0>
  <XSPICE_A A2 1 -300 1020 -208 -23 0 1 "[v,v],v" 1 "summer_error" 1>
  <C C4 1 -520 810 -26 17 0 0 "7.5 nF" 1 "" 0 "neutral" 0>
  <R R11 1 -590 960 15 -26 0 1 "270 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R12 1 -520 920 -26 -53 0 2 "20 kOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R9 1 -590 1130 15 -26 0 1 "97 kOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R10 1 -590 1230 15 -26 0 1 "3 kOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <XSPICE_A A1 1 -10 1140 62 -26 0 1 "v,v,v,v" 1 "pwm_pulse" 1>
  <GND * 1 -140 1340 0 0 0 0>
  <XSPICE_A A4 1 -80 1240 -63 -74 0 0 "v,v" 1 "clk" 1>
  <GND * 1 20 1180 0 0 0 0>
  <Vdc V6 1 -140 1290 18 -26 0 1 "0 V" 1>
  <XSPICE_A A8 1 -140 1060 -68 -80 0 0 "v,v" 1 "limiter_0_10" 1>
  <Vdc V5 1 -460 1330 18 -26 0 1 "0.319 V" 1>
  <R R15 1 -630 700 -26 15 0 0 "0.01 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
</Components>
<Wires>
  <700 170 700 250 "" 0 0 0 "">
  <700 470 700 570 "" 0 0 0 "">
  <700 310 700 370 "" 0 0 0 "">
  <460 570 700 570 "" 0 0 0 "">
  <460 170 700 170 "" 0 0 0 "">
  <460 170 460 250 "" 0 0 0 "">
  <460 470 460 570 "" 0 0 0 "">
  <460 310 460 370 "" 0 0 0 "">
  <700 370 700 410 "" 0 0 0 "">
  <640 370 650 370 "" 0 0 0 "">
  <1220 320 1220 380 "" 0 0 0 "">
  <1220 320 1360 320 "V_O" 1310 290 61 "">
  <1360 320 1460 320 "" 0 0 0 "">
  <1360 320 1360 380 "" 0 0 0 "">
  <1220 440 1220 480 "" 0 0 0 "">
  <1360 440 1360 480 "" 0 0 0 "">
  <980 280 980 300 "" 0 0 0 "">
  <1120 320 1220 320 "" 0 0 0 "">
  <980 320 1060 320 "" 0 0 0 "">
  <980 170 980 220 "" 0 0 0 "">
  <1220 540 1220 560 "" 0 0 0 "">
  <1060 170 1060 200 "" 0 0 0 "">
  <980 170 1060 170 "" 0 0 0 "">
  <1060 280 1060 300 "" 0 0 0 "">
  <980 300 980 320 "" 0 0 0 "">
  <980 300 1060 300 "" 0 0 0 "">
  <880 300 980 300 "" 0 0 0 "">
  <880 280 880 300 "" 0 0 0 "">
  <880 170 980 170 "" 0 0 0 "">
  <880 170 880 220 "" 0 0 0 "">
  <1120 220 1160 220 "" 0 0 0 "">
  <1120 200 1120 220 "" 0 0 0 "">
  <1060 200 1060 220 "" 0 0 0 "">
  <1060 200 1120 200 "" 0 0 0 "">
  <1140 240 1160 240 "" 0 0 0 "">
  <1140 240 1140 300 "" 0 0 0 "">
  <1060 300 1140 300 "" 0 0 0 "">
  <1260 170 1260 180 "" 0 0 0 "">
  <1060 170 1260 170 "" 0 0 0 "">
  <1260 240 1260 260 "" 0 0 0 "">
  <860 170 880 170 "" 0 0 0 "">
  <700 170 720 170 "" 0 0 0 "">
  <780 170 800 170 "V_VSENSE" 750 230 7 "">
  <560 370 570 370 "" 0 0 0 "">
  <460 370 460 410 "" 0 0 0 "">
  <460 370 500 370 "" 0 0 0 "">
  <600 410 600 430 "" 0 0 0 "">
  <570 410 600 410 "" 0 0 0 "">
  <570 370 580 370 "" 0 0 0 "">
  <570 370 570 410 "" 0 0 0 "">
  <620 410 620 430 "" 0 0 0 "">
  <620 410 650 410 "" 0 0 0 "">
  <650 370 670 370 "" 0 0 0 "">
  <650 370 650 410 "" 0 0 0 "">
  <1360 540 1360 620 "" 0 0 0 "">
  <1220 620 1360 620 "" 0 0 0 "">
  <670 370 700 370 "" 0 0 0 "">
  <700 620 760 620 "" 0 0 0 "">
  <700 570 700 620 "" 0 0 0 "">
  <1480 320 1480 620 "" 0 0 0 "">
  <1360 620 1480 620 "" 0 0 0 "">
  <940 620 980 620 "" 0 0 0 "">
  <760 620 880 620 "" 0 0 0 "">
  <760 920 760 1000 "" 0 0 0 "">
  <600 920 760 920 "" 0 0 0 "">
  <600 920 600 940 "" 0 0 0 "">
  <600 1000 600 1020 "" 0 0 0 "">
  <780 1000 780 1030 "" 0 0 0 "">
  <760 1000 780 1000 "" 0 0 0 "">
  <780 1130 780 1160 "" 0 0 0 "">
  <760 1160 780 1160 "" 0 0 0 "">
  <720 1030 730 1030 "" 0 0 0 "">
  <720 1130 730 1130 "" 0 0 0 "">
  <760 1060 760 1080 "" 0 0 0 "">
  <760 1080 760 1100 "" 0 0 0 "">
  <760 1080 920 1080 "" 0 0 0 "">
  <1040 1080 1040 1100 "" 0 0 0 "">
  <980 1080 1020 1080 "V_G" 930 1030 6 "">
  <760 1160 760 1190 "" 0 0 0 "">
  <220 1150 220 1190 "" 0 0 0 "">
  <360 1150 360 1190 "" 0 0 0 "">
  <360 1080 360 1090 "" 0 0 0 "">
  <220 1190 360 1190 "" 0 0 0 "">
  <220 1090 220 1100 "" 0 0 0 "">
  <220 1080 360 1080 "" 0 0 0 "">
  <220 1080 220 1090 "" 0 0 0 "">
  <720 1030 720 1080 "" 0 0 0 "">
  <720 1080 720 1130 "" 0 0 0 "">
  <540 1080 580 1080 "" 0 0 0 "">
  <580 1190 680 1190 "" 0 0 0 "">
  <580 1140 580 1190 "" 0 0 0 "">
  <580 1140 600 1140 "" 0 0 0 "">
  <580 1080 720 1080 "V_DRV_G" 630 1040 40 "">
  <580 1080 580 1120 "" 0 0 0 "">
  <580 1120 600 1120 "" 0 0 0 "">
  <400 1120 420 1120 "" 0 0 0 "">
  <360 1080 400 1080 "" 0 0 0 "">
  <400 1080 460 1080 "" 0 0 0 "">
  <400 1080 400 1120 "" 0 0 0 "">
  <400 1140 420 1140 "" 0 0 0 "">
  <360 1190 400 1190 "" 0 0 0 "">
  <400 1190 580 1190 "" 0 0 0 "">
  <400 1140 400 1190 "" 0 0 0 "">
  <980 320 980 420 "" 0 0 0 "">
  <980 620 1220 620 "V_ISENSE" 1110 590 97 "">
  <980 480 980 620 "" 0 0 0 "">
  <870 420 920 420 "" 0 0 0 "">
  <680 1190 760 1190 "" 0 0 0 "">
  <-490 720 -450 720 "" 0 0 0 "">
  <-590 740 -560 740 "" 0 0 0 "">
  <-590 920 -590 930 "" 0 0 0 "">
  <-590 920 -550 920 "" 0 0 0 "">
  <-590 990 -590 1010 "" 0 0 0 "">
  <-490 920 -450 920 "" 0 0 0 "">
  <-590 740 -590 810 "" 0 0 0 "">
  <-590 810 -590 920 "" 0 0 0 "">
  <-590 810 -550 810 "" 0 0 0 "">
  <-450 720 -450 810 "" 0 0 0 "">
  <-450 810 -450 920 "" 0 0 0 "">
  <-490 810 -450 810 "" 0 0 0 "">
  <-590 1060 -590 1100 "" 0 0 0 "">
  <-630 1060 -590 1060 "" 0 0 0 "">
  <-590 1260 -590 1300 "" 0 0 0 "">
  <-460 1170 -460 1180 "" 0 0 0 "">
  <-590 1160 -590 1170 "" 0 0 0 "">
  <-590 1170 -590 1200 "" 0 0 0 "">
  <-590 1170 -460 1170 "" 0 0 0 "">
  <-460 1260 -460 1300 "" 0 0 0 "">
  <-460 1360 -460 1380 "" 0 0 0 "">
  <-400 1260 -400 1280 "" 0 0 0 "">
  <-450 920 -330 920 "V_ISENSE_FILTERED" -410 860 102 "">
  <-330 920 -330 980 "" 0 0 0 "">
  <-400 1280 -330 1280 "V_VSENSE_DIVIDED" -410 1380 12 "">
  <-330 1060 -330 1280 "" 0 0 0 "">
  <-600 700 -560 700 "" 0 0 0 "">
  <-140 1240 -140 1260 "" 0 0 0 "">
  <-140 1240 -120 1240 "" 0 0 0 "">
  <-140 1320 -140 1340 "" 0 0 0 "">
  <-40 1180 -40 1240 "" 0 0 0 "">
  <-270 1060 -180 1060 "" 0 0 0 "">
  <-40 1060 -40 1100 "" 0 0 0 "">
  <-100 1060 -40 1060 "" 0 0 0 "">
  <20 1080 20 1100 "" 0 0 0 "">
  <20 1080 220 1080 "V_PWM" 170 1050 121 "">
  <870 420 870 420 "V_G" 900 390 0 "">
  <-270 1060 -270 1060 "V_ERR" -300 1120 0 "">
  <-40 1240 -40 1240 "V_CLK" -20 1250 0 "">
  <-660 700 -660 700 "V_ISENSE" -749 660 0 "">
  <-630 1060 -630 1060 "V_VSENSE" -700 1080 0 "">
</Wires>
<Diagrams>
</Diagrams>
<Paintings>
</Paintings>
