<Qucs Schematic 0.0.22>
<Properties>
  <View=0,-4,2000,2300,0.751315,0,0>
  <Grid=10,10,1>
  <DataSet=bridge_active_pfc_dual_sw_current_ctl.dat>
  <DataDisplay=bridge_active_pfc_dual_sw_current_ctl.dpl>
  <OpenDisplay=1>
  <Script=bridge_active_pfc_dual_sw_current_ctl.m>
  <RunScript=0>
  <showFrame=0>
  <FrameText0=Title>
  <FrameText1=Drawn By:>
  <FrameText2=Date:>
  <FrameText3=Revision:>
</Properties>
<Symbol>
</Symbol>
<Components>
  <DIODE_SPICE D1 1 700 280 15 -26 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0>
  <DIODE_SPICE D2 1 700 440 15 -26 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0>
  <SpiceModel DI_1N1 1 190 750 -30 15 0 0 ".MODEL DI_1N5408 D  ( IS=63.0n RS=14.1m BV=1.00k IBV=10.0u " 1 "+ CJO=53.0p  M=0.333 N=1.70 TT=4.32n )" 1 "" 0 "" 0 "Line_5=" 0>
  <DIODE_SPICE D3 1 460 280 15 -26 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0>
  <DIODE_SPICE D4 1 460 440 11 10 0 1 "DI_1N5408" 1 "" 0 "" 0 "" 0 "" 0>
  <VProbe Pr1 1 1470 300 28 -31 0 0>
  <R R1 1 1360 510 15 -26 0 1 "{R_LOAD}" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <IProbe Pr2 1 1220 410 -41 -26 0 3>
  <IProbe Pr3 1 1360 410 -41 -26 0 3>
  <NutmegEq NutmegBridge1 1 1120 680 -27 15 0 0 "tran" 1 "P_L_t=V(Pr1) * vpr4#branch" 1 "P_I_t=V(Pr5) * vpr2#branch" 1 "V_I_rms=sqrt(mean(V(Pr5)^2))" 1 "I_I_rms=sqrt(mean(vpr2#branch^2))" 1 "V_O_rms=sqrt(mean(V(Pr1)^2))" 1 "I_O_rms=sqrt(mean(vpr4#branch^2))" 1 "V_O_ripple=vecmax(V(Pr1)) - vecmin(V(Pr1))" 1>
  <R R3 1 1220 590 15 -26 0 1 "0.2 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R6 1 880 250 -35 34 0 1 "10 MegOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <VProbe Pr7 1 1180 230 -16 28 0 3>
  <SpiceModel SpiceModel_DI_ES3C1 1 190 850 -30 15 0 0 ".MODEL DI_ES3C D  ( IS=7.27p RS=22.4m BV=1.00k IBV=10.0u" 1 "+ CJO=83.2p  M=0.333 N=0.700 TT=36.0n )" 1 "" 0 "" 0 "Line_5=" 0>
  <GND * 1 1260 260 0 0 0 0>
  <C C3 0 1260 210 17 -26 0 1 "10 uF" 1 "" 0 "neutral" 0>
  <R R2 1 830 170 -26 15 0 0 "0.2 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <IProbe Pr8 1 750 170 -26 16 0 0>
  <SpiceModel SpiceModel_DI_ES3C2 1 210 1270 -30 15 0 0 ".MODEL DI_ES3C2 D  ( IS=7.27p RS=22.4m BV=1.00k IBV=10.0u" 1 "+ CJO=83.2p  M=0.333 N=0.700 TT=0.0n )" 1 "" 0 "" 0 "Line_5=" 0>
  <IProbe Pr4 1 530 370 -26 16 1 2>
  <VProbe Pr5 1 610 450 -57 3 1 0>
  <SpiceModel SpiceModel_pmod_g_drv 1 210 1450 -30 15 0 0 ".MODEL pmod_g_drv pmos(VTO=-2.0 KP=0.010)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SpiceModel_nmod_g_drv 1 210 1370 -30 15 0 0 ".MODEL nmod_g_drv nmos(VTO=3.0 KP=0.015)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <R R8 2 910 620 -26 15 0 0 "{R_SENSE}" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <INCLSCR INCLSCR1 1 220 240 -68 15 0 0 "\n.CONTROL\nSET D_BRIDGE_MODEL=''DI_1N5408''\n.ENDC" 1 "" 0 "" 0>
  <GND * 1 680 1690 0 0 0 0>
  <XSPICE_A A3 1 840 1900 -49 -108 0 1 "[v,v],v" 1 "mult_ref" 1>
  <GND * 1 810 2060 0 0 0 0>
  <XSPICE_A A2 1 970 1700 -208 -23 0 1 "[v,v],v" 1 "summer_error" 1>
  <C C4 1 750 1490 -26 17 0 0 "7.5 nF" 1 "" 0 "neutral" 0>
  <R R11 1 680 1640 15 -26 0 1 "270 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R12 1 750 1600 -26 -53 0 2 "20 kOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R9 1 680 1810 15 -26 0 1 "97 kOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R10 1 680 1910 15 -26 0 1 "3 kOhm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <SpicePar BOOST_PFC_PARAM 1 1580 180 -29 15 0 0 "PI=3.1415927" 1 "V_F=0.7" 1 "V_LINE_MIN_RMS=85" 1 "V_LINE_MAX_RMS=265" 1 "V_LINE_NOM_RMS=230" 1 "V_LINE_NOM_PK={V_LINE_NOM_RMS * sqrt(2)}V" 1 "V_LINE_MAX_PK={V_LINE_MAX_RMS * sqrt(2)}V" 1 "V_LINE_MIN_PK={V_LINE_MIN_RMS * sqrt(2)}V" 1 "V_RECT_NOM_RMS={(V_LINE_NOM_PK - 2 * V_F) / sqrt(2)}" 1 "V_RECT_MIN_RMS={(V_LINE_MIN_PK - 2 * V_F) / sqrt(2)}" 1 "V_AVG={V_LINE_NOM_PK * 2 / PI}V" 1 "V_O=371.5V" 1 "ETA_EST=0.90" 1 "P_LOAD=96.0W" 1 "P_IN={P_LOAD / ETA_EST}" 1 "R_LOAD={V_O^2 / P_LOAD}O" 1 "F_S=200k" 1 "T_S={1 / F_S}" 1 "D=0.1281" 1 "T_ON={T_S * D}" 1 "T_OFF={T_S * (1 - D)}" 1 "T_R=5e-9" 1 "T_F=5e-9" 1 "R_SENSE=100mO" 1 "I_SENSE_NOM_PK={P_IN / V_RECT_NOM_RMS * sqrt(2)}" 1 "I_SENSE_MAX_PK={P_IN / V_RECT_MIN_RMS * sqrt(2)}" 1 "V_ISENSE_FS=10V" 1>
  <SpiceModel SpiceModel_mult_ref 1 210 1800 -30 15 0 0 ".MODEL mult_ref mult" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SpiceModel_summer_error 1 210 1690 -30 15 0 0 ".MODEL summer_error summer( in_offset = [0.0 0.0]," 1 "+   in_gain = [1.0 -1.0])" 1 "" 0 "" 0 "Line_5=" 0>
  <R R13 0 1000 1790 -91 -17 0 1 "50 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <GND * 0 1000 1820 0 0 0 0>
  <GND * 0 640 1380 0 0 0 0>
  <SpiceModel SpiceModel_pwm_pulse 1 210 1560 -30 15 0 0 ".MODEL pwm_pulse oneshot(cntl_array = [0 10]," 1 "+   pw_array=[0 {T_S}], out_low=-1.0, out_high=1.0," 1 "+   fall_time=5.0e-9, rise_time=5.0e-9)" 1 "" 0 "Line_5=" 0>
  <GND * 0 670 370 0 0 0 0>
  <SpiceModel SpiceModel_gain_inv_1 1 210 2120 -30 15 0 0 ".MODEL gain_inv_1 gain(gain = -1.0, out_offset = 12.0)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <SpiceModel SWITCH1 1 190 660 -30 15 0 0 ".model switch1 sw vt=0.0 vh=0.2 ron=0.03 roff=5e6" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <S4Q_S S1 1 980 410 -108 5 0 1 "switch1" 1 "" 0 "" 0 "" 0 "" 0>
  <GND * 1 950 530 0 0 0 0>
  <.DC DC1 0 650 690 0 40 0 0 "26.85" 0 "0.001" 0 "1 pA" 0 "1 uV" 0 "no" 0 "150" 0 "no" 0 "none" 0 "CroutLU" 0>
  <SpiceModel SpiceModel_clk 1 210 1890 -30 15 0 0 ".MODEL clk square( cntl_array = [-1 1]," 1 "+   freq_array = [{F_S/2} {3*F_S/2}]," 1 "+   out_low = -1.0, out_high = 1.0," 1 "+   duty_cycle = 0.02" 1 "Line_5=+   rise_time = 5.0e-9, fall_time = 5.0e-9)" 1>
  <SpiceOptions SpiceOptions1 1 190 400 -37 15 0 0 "DEVICE" 0 "GMIN=1e-12" 1 "METHOD=gear" 1 "RELTOL=1m" 1 "VNTOL=1m" 1 "ABSTOL=1u" 1>
  <SpiceModel SpiceModel_gain_inv 1 210 2030 -30 15 0 0 ".MODEL gain_inv gain(gain = -1.0, out_offset = 0.0)" 1 "" 0 "" 0 "" 0 "Line_5=" 0>
  <GND * 1 1100 440 0 0 0 0>
  <S4Q_S S2 1 1090 320 -74 63 0 2 "switch1" 1 "" 0 "" 0 "" 0 "" 0>
  <SPICEINIT SPICEINIT1 1 190 580 -31 15 0 0 "set ngbehavior=ltpsa" 1>
  <Vac V1 1 610 370 -35 -71 0 2 "{V_LINE_NOM_PK}" 1 "50 Hz" 1 "90" 0 "0" 0>
  <GND * 1 820 620 0 0 0 0>
  <GND * 1 680 1980 0 0 0 0>
  <OpAmp OP1 1 740 1400 -26 42 0 0 "1e6" 1 "15 V" 0>
  <SpiceModel SpiceModel_limiter_0_1 1 210 2210 -30 15 0 0 ".MODEL limiter_0_10 limit(out_lower_limit=0.0," 1 "+   out_upper_limit=10.0)" 1 "" 0 "" 0 "Line_5=" 0>
  <GND * 1 1300 1880 0 0 0 0>
  <XSPICE_A A5 1 1500 1780 -35 -76 0 0 "v,v" 1 "gain_inv" 1>
  <XSPICE_A A8 1 1120 1760 -68 -80 0 0 "v,v" 1 "limiter_0_10" 1>
  <XSPICE_A A4 1 1200 1940 -63 -74 0 0 "v,v" 1 "clk" 1>
  <GND * 1 1140 2040 0 0 0 0>
  <XSPICE_A A7 1 1340 1940 -30 44 0 0 "v,v" 1 "gain_inv" 1>
  <Vdc V7 0 1300 1670 18 -26 0 1 "1.281 V" 1>
  <GND * 0 1300 1700 0 0 0 0>
  <XSPICE_A A1 1 1270 1820 62 -26 0 1 "v,v,v,v" 1 "pwm_pulse" 1>
  <Vdc V6 1 1140 1990 18 -26 0 1 "0 V" 1>
  <R R15 1 1600 1910 15 -26 0 1 "50 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <GND * 1 1600 1940 0 0 0 0>
  <Vdc V5 1 810 2010 18 -26 0 1 "0.319 V" 1>
  <C C1 1 1220 510 17 -26 0 1 "914u" 1 "-370" 1 "neutral" 0>
  <.TR TR1 1 840 680 0 66 0 0 "lin" 1 "0 ms" 1 "10 ms" 1 "10001" 1 "Gear" 1 "2" 1 "1 ns" 0 "1e-16" 0 "150" 0 "0.01" 0 "1 uA" 0 "1 mV" 0 "26.85" 0 "1e-3" 0 "1e-6" 0 "1" 0 "CroutLU" 0 "no" 0 "no" 1 "100ns" 1>
  <L L1 1 980 250 5 -46 0 1 "2.7 mH" 1 "-0.1" 1>
  <C C2 1 1060 250 17 -26 0 1 "1 pF" 1 "-1.0" 1 "neutral" 0>
  <R R14 1 950 500 15 -26 0 1 "300 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
  <R R18 1 1100 410 15 -26 0 1 "300 Ohm" 1 "26.85" 0 "0.0" 0 "0.0" 0 "26.85" 0 "european" 0>
</Components>
<Wires>
  <700 170 700 250 "" 0 0 0 "">
  <700 470 700 570 "" 0 0 0 "">
  <700 310 700 370 "" 0 0 0 "">
  <460 570 700 570 "" 0 0 0 "">
  <460 170 700 170 "" 0 0 0 "">
  <460 170 460 250 "" 0 0 0 "">
  <460 470 460 570 "" 0 0 0 "">
  <460 310 460 370 "" 0 0 0 "">
  <700 370 700 410 "" 0 0 0 "">
  <1220 320 1220 380 "" 0 0 0 "">
  <1220 320 1360 320 "V_O" 1310 290 61 "">
  <1360 320 1460 320 "" 0 0 0 "">
  <1360 320 1360 380 "" 0 0 0 "">
  <1220 440 1220 480 "" 0 0 0 "">
  <1360 440 1360 480 "" 0 0 0 "">
  <980 280 980 300 "" 0 0 0 "">
  <1120 320 1220 320 "" 0 0 0 "">
  <980 320 1060 320 "" 0 0 0 "">
  <980 170 980 220 "" 0 0 0 "">
  <1220 540 1220 560 "" 0 0 0 "">
  <1060 170 1060 200 "" 0 0 0 "">
  <980 170 1060 170 "" 0 0 0 "">
  <1060 280 1060 300 "" 0 0 0 "">
  <980 300 980 320 "" 0 0 0 "">
  <980 300 1060 300 "" 0 0 0 "">
  <880 300 980 300 "" 0 0 0 "">
  <880 280 880 300 "" 0 0 0 "">
  <880 170 980 170 "" 0 0 0 "">
  <880 170 880 220 "" 0 0 0 "">
  <1120 220 1160 220 "" 0 0 0 "">
  <1120 200 1120 220 "" 0 0 0 "">
  <1060 200 1060 220 "" 0 0 0 "">
  <1060 200 1120 200 "" 0 0 0 "">
  <1140 240 1160 240 "" 0 0 0 "">
  <1140 240 1140 300 "" 0 0 0 "">
  <1060 300 1140 300 "" 0 0 0 "">
  <1260 170 1260 180 "" 0 0 0 "">
  <1060 170 1260 170 "" 0 0 0 "">
  <1260 240 1260 260 "" 0 0 0 "">
  <860 170 880 170 "" 0 0 0 "">
  <700 170 720 170 "" 0 0 0 "">
  <780 170 800 170 "V_VSENSE" 750 230 7 "">
  <560 370 570 370 "" 0 0 0 "">
  <460 370 460 410 "" 0 0 0 "">
  <460 370 500 370 "" 0 0 0 "">
  <600 410 600 430 "" 0 0 0 "">
  <570 410 600 410 "" 0 0 0 "">
  <570 370 570 410 "" 0 0 0 "">
  <620 410 620 430 "" 0 0 0 "">
  <620 410 650 410 "" 0 0 0 "">
  <650 370 670 370 "" 0 0 0 "">
  <650 370 650 410 "" 0 0 0 "">
  <980 320 980 380 "" 0 0 0 "">
  <1360 540 1360 620 "" 0 0 0 "">
  <1220 620 1360 620 "" 0 0 0 "">
  <980 440 980 620 "" 0 0 0 "">
  <980 620 1220 620 "V_ISENSE" 1110 590 97 "">
  <940 620 980 620 "" 0 0 0 "">
  <680 1600 680 1610 "" 0 0 0 "">
  <680 1600 720 1600 "" 0 0 0 "">
  <680 1670 680 1690 "" 0 0 0 "">
  <780 1600 820 1600 "" 0 0 0 "">
  <680 1490 680 1600 "" 0 0 0 "">
  <680 1490 720 1490 "" 0 0 0 "">
  <820 1490 820 1600 "" 0 0 0 "">
  <780 1490 820 1490 "" 0 0 0 "">
  <680 1740 680 1780 "" 0 0 0 "">
  <640 1740 680 1740 "" 0 0 0 "">
  <810 1850 810 1860 "" 0 0 0 "">
  <680 1840 680 1850 "" 0 0 0 "">
  <680 1850 680 1880 "" 0 0 0 "">
  <680 1850 810 1850 "" 0 0 0 "">
  <810 1940 810 1980 "" 0 0 0 "">
  <810 2040 810 2060 "" 0 0 0 "">
  <870 1940 870 1960 "" 0 0 0 "">
  <820 1600 940 1600 "V_ISENSE_FILTERED" 860 1540 102 "">
  <940 1600 940 1660 "" 0 0 0 "">
  <870 1960 940 1960 "" 0 0 0 "">
  <940 1740 940 1960 "" 0 0 0 "">
  <1000 1740 1000 1760 "" 0 0 0 "">
  <670 370 700 370 "" 0 0 0 "">
  <700 620 820 620 "" 0 0 0 "">
  <700 570 700 620 "" 0 0 0 "">
  <1480 320 1480 620 "" 0 0 0 "">
  <1360 620 1480 620 "" 0 0 0 "">
  <880 400 950 400 "" 0 0 0 "">
  <950 420 950 470 "" 0 0 0 "">
  <1100 350 1100 380 "" 0 0 0 "">
  <1010 350 1080 350 "" 0 0 0 "">
  <640 370 650 370 "" 0 0 0 "">
  <570 370 580 370 "" 0 0 0 "">
  <820 620 880 620 "" 0 0 0 "">
  <680 1940 680 1980 "" 0 0 0 "">
  <820 1400 820 1490 "" 0 0 0 "">
  <780 1400 820 1400 "" 0 0 0 "">
  <640 1380 710 1380 "V_ISENSE" 690 1330 23 "">
  <680 1420 680 1490 "" 0 0 0 "">
  <680 1420 710 1420 "" 0 0 0 "">
  <1000 1760 1080 1760 "V_ERR" 1050 1800 25 "">
  <1140 2020 1140 2040 "" 0 0 0 "">
  <1540 1780 1620 1780 "V_G_PRIME" 1590 1700 40 "">
  <1300 1780 1460 1780 "V_G" 1390 1750 59 "">
  <1300 1860 1300 1880 "" 0 0 0 "">
  <1240 1760 1240 1780 "" 0 0 0 "">
  <1160 1760 1240 1760 "" 0 0 0 "">
  <1240 1860 1240 1940 "" 0 0 0 "">
  <1240 1640 1240 1760 "" 0 0 0 "">
  <1240 1640 1300 1640 "" 0 0 0 "">
  <1380 1940 1440 1940 "V_CLK_PRIME" 1420 1980 20 "">
  <1240 1940 1300 1940 "V_CLK" 1250 1970 27 "">
  <1140 1940 1140 1960 "" 0 0 0 "">
  <1140 1940 1160 1940 "" 0 0 0 "">
  <1540 1860 1600 1860 "V_SINK" 1600 1830 30 "">
  <1600 1860 1600 1880 "" 0 0 0 "">
  <640 1740 640 1740 "V_VSENSE" 570 1760 0 "">
  <880 400 880 400 "V_G" 850 360 0 "">
  <1010 350 1010 350 "V_G_PRIME" 990 360 0 "">
</Wires>
<Diagrams>
</Diagrams>
<Paintings>
</Paintings>
